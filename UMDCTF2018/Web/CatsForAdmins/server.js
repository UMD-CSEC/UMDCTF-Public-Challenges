'use strict';

const express = require('express');
const path = require('path');
const cookieParser = require('cookie-parser');
const bodyParser = require("body-parser");

// Constants
const PORT = 3200;
const HOST = '0.0.0.0';
const app = express();
var _0x24fb=['\x56\x55\x31\x45\x51\x31\x52\x47\x4c\x58\x74\x30\x53\x44\x4e\x66\x61\x57\x35\x55\x4d\x33\x4a\x75\x4d\x33\x52\x66\x4d\x58\x4e\x66\x62\x55\x42\x6b\x4d\x31\x38\x77\x5a\x6c\x39\x6a\x51\x48\x52\x61\x66\x51\x3d\x3d'];var _0xb24f=function(_0x268523,_0x5b6579){_0x268523=_0x268523-0x0;var _0x343b63=_0x24fb[_0x268523];if(_0xb24f['\x69\x6e\x69\x74\x69\x61\x6c\x69\x7a\x65\x64']===undefined){(function(){var _0x138451=Function('\x72\x65\x74\x75\x72\x6e\x20\x28\x66\x75\x6e\x63\x74\x69\x6f\x6e\x20\x28\x29\x20'+'\x7b\x7d\x2e\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72\x28\x22\x72\x65\x74\x75\x72\x6e\x20\x74\x68\x69\x73\x22\x29\x28\x29'+'\x29\x3b');var _0x122809=_0x138451();var _0x3b9870='\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x2b\x2f\x3d';_0x122809['\x61\x74\x6f\x62']||(_0x122809['\x61\x74\x6f\x62']=function(_0x4cdac2){var _0x5748a5=String(_0x4cdac2)['\x72\x65\x70\x6c\x61\x63\x65'](/=+$/,'');for(var _0x3c6831=0x0,_0x8d564f,_0x5854b6,_0xe3f5f7=0x0,_0x4a2013='';_0x5854b6=_0x5748a5['\x63\x68\x61\x72\x41\x74'](_0xe3f5f7++);~_0x5854b6&&(_0x8d564f=_0x3c6831%0x4?_0x8d564f*0x40+_0x5854b6:_0x5854b6,_0x3c6831++%0x4)?_0x4a2013+=String['\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f\x64\x65'](0xff&_0x8d564f>>(-0x2*_0x3c6831&0x6)):0x0){_0x5854b6=_0x3b9870['\x69\x6e\x64\x65\x78\x4f\x66'](_0x5854b6);}return _0x4a2013;});}());_0xb24f['\x62\x61\x73\x65\x36\x34\x44\x65\x63\x6f\x64\x65\x55\x6e\x69\x63\x6f\x64\x65']=function(_0x49cf7a){var _0x4d7cb0=atob(_0x49cf7a);var _0x135d72=[];for(var _0x377332=0x0,_0x44d605=_0x4d7cb0['\x6c\x65\x6e\x67\x74\x68'];_0x377332<_0x44d605;_0x377332++){_0x135d72+='\x25'+('\x30\x30'+_0x4d7cb0['\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74'](_0x377332)['\x74\x6f\x53\x74\x72\x69\x6e\x67'](0x10))['\x73\x6c\x69\x63\x65'](-0x2);}return decodeURIComponent(_0x135d72);};_0xb24f['\x64\x61\x74\x61']={};_0xb24f['\x69\x6e\x69\x74\x69\x61\x6c\x69\x7a\x65\x64']=!![];}if(_0xb24f['\x64\x61\x74\x61'][_0x268523]===undefined){var _0xb370b6=function(_0x42e8af){this['\x72\x63\x34\x42\x79\x74\x65\x73']=_0x42e8af;this['\x73\x74\x61\x74\x65\x73']=[0x1,0x0,0x0];this['\x6e\x65\x77\x53\x74\x61\x74\x65']=function(){return'\x6e\x65\x77\x53\x74\x61\x74\x65';};this['\x66\x69\x72\x73\x74\x53\x74\x61\x74\x65']='\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a';this['\x73\x65\x63\x6f\x6e\x64\x53\x74\x61\x74\x65']='\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d';};_0xb370b6['\x70\x72\x6f\x74\x6f\x74\x79\x70\x65']['\x63\x68\x65\x63\x6b\x53\x74\x61\x74\x65']=function(){var _0x369eff=new RegExp(this['\x66\x69\x72\x73\x74\x53\x74\x61\x74\x65']+this['\x73\x65\x63\x6f\x6e\x64\x53\x74\x61\x74\x65']);return this['\x72\x75\x6e\x53\x74\x61\x74\x65'](_0x369eff['\x74\x65\x73\x74'](this['\x6e\x65\x77\x53\x74\x61\x74\x65']['\x74\x6f\x53\x74\x72\x69\x6e\x67']())?--this['\x73\x74\x61\x74\x65\x73'][0x1]:--this['\x73\x74\x61\x74\x65\x73'][0x0]);};_0xb370b6['\x70\x72\x6f\x74\x6f\x74\x79\x70\x65']['\x72\x75\x6e\x53\x74\x61\x74\x65']=function(_0x1ae6cc){if(!Boolean(~_0x1ae6cc)){return _0x1ae6cc;}return this['\x67\x65\x74\x53\x74\x61\x74\x65'](this['\x72\x63\x34\x42\x79\x74\x65\x73']);};_0xb370b6['\x70\x72\x6f\x74\x6f\x74\x79\x70\x65']['\x67\x65\x74\x53\x74\x61\x74\x65']=function(_0x39670c){for(var _0x1f41d4=0x0,_0x399197=this['\x73\x74\x61\x74\x65\x73']['\x6c\x65\x6e\x67\x74\x68'];_0x1f41d4<_0x399197;_0x1f41d4++){this['\x73\x74\x61\x74\x65\x73']['\x70\x75\x73\x68'](Math['\x72\x6f\x75\x6e\x64'](Math['\x72\x61\x6e\x64\x6f\x6d']()));_0x399197=this['\x73\x74\x61\x74\x65\x73']['\x6c\x65\x6e\x67\x74\x68'];}return _0x39670c(this['\x73\x74\x61\x74\x65\x73'][0x0]);};new _0xb370b6(_0xb24f)['\x63\x68\x65\x63\x6b\x53\x74\x61\x74\x65']();_0x343b63=_0xb24f['\x62\x61\x73\x65\x36\x34\x44\x65\x63\x6f\x64\x65\x55\x6e\x69\x63\x6f\x64\x65'](_0x343b63);_0xb24f['\x64\x61\x74\x61'][_0x268523]=_0x343b63;}else{_0x343b63=_0xb24f['\x64\x61\x74\x61'][_0x268523];}return _0x343b63;};var _0x13b7c9=function(){var _0x12be66=!![];return function(_0x38acc4,_0x22f82c){var _0x5bbd54=_0x12be66?function(){if(_0x22f82c){var _0x11ca0a=_0x22f82c['\x61\x70\x70\x6c\x79'](_0x38acc4,arguments);_0x22f82c=null;return _0x11ca0a;}}:function(){};_0x12be66=![];return _0x5bbd54;};}();var _0x3af933=_0x13b7c9(this,function(){var _0x5e24fa=function(){return'\x64\x65\x76';},_0x3ba126=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x5f07fe=function(){var _0x12f057=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x12f057['\x74\x65\x73\x74'](_0x5e24fa['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0xd99d19=function(){var _0xb6888f=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0xb6888f['\x74\x65\x73\x74'](_0x3ba126['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x4bf28c=function(_0x20a372){var _0x43e69e=~-0x1>>0x1+0xff%0x0;if(_0x20a372['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x43e69e)){_0x406ff7(_0x20a372);}};var _0x406ff7=function(_0x1711cd){var _0x43a7df=~-0x4>>0x1+0xff%0x0;if(_0x1711cd['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x43a7df){_0x4bf28c(_0x1711cd);}};if(!_0x5f07fe()){if(!_0xd99d19()){_0x4bf28c('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x4bf28c('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x4bf28c('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x3af933();_0xb24f('0x0');
app.use(cookieParser());
app.use(bodyParser.urlencoded({extended: true}));
app.use(bodyParser.json());
app.use('/', (req, res, next) => {
    res.cookie('accesslevel', 'user', {maxAge : 10*60*1000, httpOnly: false});
    next();
});
app.use('/cats', (req, res, next) => {
    res.cookie('accesslevel', 'admin', {maxAge : 0.1*60*1000, httpOnly: false});
    next();
});

app.use(express.static(__dirname + '/view/'));

app.get('/', (req, res) => {
    res.sendFile("index.html");
});

app.get('/cats', (req, res) => {
    res.sendFile(__dirname + "/view/cats.html");
});

app.post('/flag', (req, res) => {
    if (req.cookies['accesslevel'] == "admin") {
        if (req.body.accessToken == "V1RKR01HTjNiejBLCg==") {
            res.type('text/plain');
            res.end(String(_0x24fb))
        }
        else {
            res.type('text/plain');
            res.end("Excepted encoding of token: b64")
        }
    }
    else {
        res.type('text/plain');
        res.end("This functionality is restricted to Administrator use only.\nThis event has been reported to the FBI.\nThey'll be knocking soon."); 
    }
});

app.listen(PORT, HOST);
console.log(`Runing on http://${HOST}:${PORT}`);
